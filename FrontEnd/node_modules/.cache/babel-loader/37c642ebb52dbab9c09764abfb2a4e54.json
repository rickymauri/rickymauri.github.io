{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\Utente\\\\Desktop\\\\progettoevoli\\\\FrontEnd\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"C:\\\\Users\\\\Utente\\\\Desktop\\\\progettoevoli\\\\FrontEnd\\\\src\\\\context\\\\SocketContext.js\";\nimport React, { createContext, useReducer } from 'react';\nimport SocketReducer from './SocketReducer';\nimport io from 'socket.io-client';\nvar initialState = {\n  //Client socket reference\n  socket: null,\n  teacherId: '',\n  studentId: '',\n  isClosed: true,\n  formId: '',\n  formCode: '',\n  feedbacksList: {\n    understandingValue: [],\n    complexityValue: [],\n    explainationValue: []\n  },\n  numberOfConnectedStudents: 0,\n  questions: [],\n  questionsLiked: []\n};\nexport var SocketContext = createContext(initialState);\nexport var SocketProvider = function SocketProvider(_ref) {\n  var children = _ref.children;\n  var _useReducer = useReducer(SocketReducer, initialState),\n    _useReducer2 = _slicedToArray(_useReducer, 2),\n    state = _useReducer2[0],\n    dispatch = _useReducer2[1];\n  function initSocket(teacher, username, title, code) {\n    var socket = io.connect('http://localhost:8080', {\n      query: {\n        isTeacher: teacher,\n        username: username,\n        title: title,\n        code: code\n      }\n    });\n    bindListeners(socket);\n    dispatch({\n      type: 'INIT_SOCKET',\n      payload: socket\n    });\n  }\n  var closeSocket = function closeSocket() {\n    state.socket.close();\n    dispatch({\n      type: 'CLOSE_SOCKET'\n    });\n  };\n  var emit = function emit(event, payload) {\n    state.socket.emit(event, payload);\n  };\n  var bindListeners = function bindListeners(socket) {\n    socket.on('teacher:feedbackResultsPage', function (formId, formCode, isClosed) {\n      dispatch({\n        type: 'ADD_FORM_ID_AND_CODE',\n        payload: {\n          formId: formId,\n          formCode: formCode,\n          isClosed: isClosed\n        }\n      });\n    });\n    socket.on('all:questionUpdate', function (question) {\n      if (question.numberOfLikes === 0) {\n        dispatch({\n          type: 'ADD_QUESTION',\n          payload: {\n            question: question\n          }\n        });\n      } else {\n        dispatch({\n          type: 'QUESTION_UPDATE',\n          payload: {\n            question: question\n          }\n        });\n      }\n    });\n    socket.on('student:submitFeedbackPage', function (studentId, formId, isClosed) {\n      dispatch({\n        type: 'ADD_STUDENT_ID_AND_FORM_ID',\n        payload: {\n          studentId: studentId,\n          formId: formId,\n          isClosed: isClosed\n        }\n      });\n      console.log(isClosed);\n    });\n    socket.on('all:feedbackResults', function (feedbacksList, numberOfConnectedStudents) {\n      dispatch({\n        type: 'ADD_FEEDBACKS',\n        payload: {\n          feedbacksList: feedbacksList,\n          numberOfConnectedStudents: numberOfConnectedStudents\n        }\n      });\n    });\n    socket.on('all:formIsClosed', function (isClosed) {\n      dispatch({\n        type: 'ADD_FORM_IS_CLOSED',\n        payload: {\n          isClosed: isClosed\n        }\n      });\n    });\n  };\n  return /*#__PURE__*/React.createElement(SocketContext.Provider, {\n    value: {\n      socket: state.socket,\n      formId: state.formId,\n      formCode: state.formCode,\n      studentId: state.studentId,\n      isClosed: state.isClosed,\n      teacherId: state.teacherId,\n      feedbacksList: state.feedbacksList,\n      numberOfConnectedStudents: state.numberOfConnectedStudents,\n      questions: state.questions,\n      questionsLiked: state.questionsLiked,\n      emit: emit,\n      initSocket: initSocket,\n      closeSocket: closeSocket\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 5\n    }\n  }, children);\n};","map":{"version":3,"names":["React","createContext","useReducer","SocketReducer","io","initialState","socket","teacherId","studentId","isClosed","formId","formCode","feedbacksList","understandingValue","complexityValue","explainationValue","numberOfConnectedStudents","questions","questionsLiked","SocketContext","SocketProvider","_ref","children","_useReducer","_useReducer2","_slicedToArray","state","dispatch","initSocket","teacher","username","title","code","connect","query","isTeacher","bindListeners","type","payload","closeSocket","close","emit","event","on","question","numberOfLikes","console","log","createElement","Provider","value","__self","_this","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["C:/Users/Utente/Desktop/progettoevoli/FrontEnd/src/context/SocketContext.js"],"sourcesContent":["import React, {createContext, useReducer} from 'react';\nimport SocketReducer from './SocketReducer';\nimport io from 'socket.io-client';\n\nconst initialState = {\n  //Client socket reference\n  socket: null,\n  teacherId: '',\n  studentId: '',\n  isClosed: true,\n  formId: '',\n  formCode: '',\n  feedbacksList: {\n    understandingValue: [],\n    complexityValue: [],\n    explainationValue: [],\n  },\n  numberOfConnectedStudents: 0,\n  questions: [],\n  questionsLiked: [],\n};\n\nexport const SocketContext = createContext(initialState);\n\nexport const SocketProvider = ({children}) => {\n\n  const [state, dispatch] = useReducer(SocketReducer, initialState);\n\n  function initSocket(teacher, username, title, code) {\n    const socket = io.connect('http://localhost:8080', {\n      query: {\n        isTeacher: teacher,\n        username: username,\n        title: title,\n        code: code\n      },\n    });\n\n    bindListeners(socket);\n\n    dispatch({\n      type: 'INIT_SOCKET',\n      payload: socket,\n    });\n  }\n\n  const closeSocket = () => {\n    state.socket.close();\n    dispatch({type: 'CLOSE_SOCKET'});\n  };\n\n  const emit = (event, payload) => {\n    state.socket.emit(event, payload);\n  };\n\n  const bindListeners = (socket) => {\n\n    socket.on('teacher:feedbackResultsPage', (formId, formCode, isClosed) => {\n      dispatch({\n        type: 'ADD_FORM_ID_AND_CODE',\n        payload: {formId, formCode, isClosed},\n      });\n    });\n  \n    socket.on('all:questionUpdate', (question) => {\n      if(question.numberOfLikes === 0) {\n        dispatch({\n        type: 'ADD_QUESTION',\n        payload: {question}\n        }); \n      } \n      else {\n        dispatch({\n          type: 'QUESTION_UPDATE',\n          payload: {question}\n        });\n      }\n    });\n    \n    socket.on('student:submitFeedbackPage', (studentId, formId, isClosed) => {\n      dispatch({\n        type: 'ADD_STUDENT_ID_AND_FORM_ID',\n        payload: {studentId, formId, isClosed},\n      })\n      console.log(isClosed);\n    })\n \n    socket.on('all:feedbackResults', (feedbacksList, numberOfConnectedStudents) => {\n      dispatch({\n        type: 'ADD_FEEDBACKS',\n        payload: {feedbacksList, numberOfConnectedStudents}\n      })\n    }\n    )\n    \n    socket.on('all:formIsClosed', (isClosed) => {\n      dispatch({\n        type: 'ADD_FORM_IS_CLOSED',\n        payload: {isClosed},\n      })\n    }\n    )\n  };\n  \n  return (\n   \n    <SocketContext.Provider\n      value={{\n        socket: state.socket,\n        formId: state.formId,\n        formCode: state.formCode,\n        studentId: state.studentId,\n        isClosed: state.isClosed,\n        teacherId: state.teacherId,\n        feedbacksList: state.feedbacksList,\n        numberOfConnectedStudents: state.numberOfConnectedStudents,\n        questions: state.questions,\n        questionsLiked: state.questionsLiked,\n        emit,\n        initSocket,\n        closeSocket,\n      }}\n    >\n      {children}\n    </SocketContext.Provider>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}